# config.yaml - Конфигурация ISUP-моста для интеграции СКУД Hikvision с 1С:УРВ
# Назначение: Автоматизация учета рабочего времени на основе событий проходов

# Настройки ISUP-сервера
isup_server:
  host: "0.0.0.0"                    # Слушать на всех интерфейсах
  port: 8080                          # Порт для приема данных от контроллеров
  max_connections: 100                # Максимальное количество одновременных подключений

# Настройки интеграции с 1С:УРВ (Учет Рабочего Времени)
1c_rest_api:
  # === НАСТРОЙКИ 1С ===
  base_url: "https://ваш-хостинг-1с.ru"  # URL облачного 1С (ЗАМЕНИТЕ)
  endpoint: "/hs/access/events"           # Путь к HTTP-сервису УРВ
  username: "скуд_интеграция"             # Пользователь для Basic Auth (ЗАМЕНИТЕ)
  password: "пароль_интеграции"           # Пароль (ЗАМЕНИТЕ)
  
  # Формат данных для государственной формы УРВ
  data_mapping:
    employee_id_field: "EmployeeID"        # Поле идентификатора сотрудника
    timestamp_field: "EventTime"           # Поле времени события  
    device_id_field: "DeviceID"            # Поле идентификатора устройства
    event_type_field: "EventType"          # Поле типа события
    direction_field: "Direction"           # Направление (вход/выход)

# Настройки бизнес-логики УРВ
business_logic:
  # Автоматическое определение рабочего дня
  auto_detect_workday: true
  default_work_start: "09:00"              # Начало рабочего дня по умолчанию
  default_work_end: "18:00"                # Окончание рабочего дня по умолчанию
  lunch_start: "13:00"                     # Начало обеденного перерыва
  lunch_end: "14:00"                       # Окончание обеденного перерыва
  
  # Интеграция с расчетом зарплаты
  enable_salary_calc: true                 # Включить влияние на расчет зарплаты
  min_work_hours: 8                        # Минимальное количество часов для полного дня
  late_tolerance_minutes: 15               # Допустимое опоздание

# Настройки устройств СКУД
devices:
  # Контроллер Hikvision F-KD-3323PEFC
  hikvision_controller:
    device_id: "CONTROLLER_001"            # Внутренний идентификатор
    location: "Главный вход"               # Местоположение
    purpose: "Учет входа/выхода"           # Назначение
    access_type: "FaceRecognition"         # Тип доступа (распознавание лиц)

# Настройки приложения
app:
  # Очередь и повторные попытки
  max_retries: 3                           # Количество попыток отправки в 1С
  retry_delay: 5                           # Задержка между попытками (сек)
  batch_size: 10                           # Размер пачки для групповой отправки
  
  # Локальное хранение (резервирование)
  local_storage_path: "./pending_events"   # Папка для неотправленных событий
  max_local_storage_days: 30               # Хранить события до 30 дней
  
  # Логирование
  log_level: "INFO"                        # Уровень логирования
  log_retention_days: 7                    # Хранить логи 7 дней
  
  # Мониторинг
  health_check_port: 8080                  # Порт для health-check
  enable_metrics: true                     # Включить сбор метрик
